# Cursor Rules for USDX Protocol

## Code Quality & Review Standards

### Code Review Requirements
- Always do a thorough multi-pass review before committing
- Remove all unused code, imports, and exports
- Ensure all added code is actually being used
- Minimize code additions - prefer refactoring existing code over adding new code
- Optimize for human readability - code should be clean, understandable, and maintainable

### CSS & Styling Guidelines
- **Maximally reuse Tailwind CSS utilities** instead of adding custom CSS
- Only add custom CSS when absolutely necessary
- Prefer Tailwind's built-in utilities and classes
- Custom CSS should be minimal and well-documented
- Avoid creating custom classes that duplicate Tailwind functionality
- **CRITICAL: Verify Tailwind class names exist** - Valid border widths are: border, border-2, border-4, border-8 (NOT border-3)
- **Design with restraint** - Use 1-2 primary colors, not 6+ different border colors
- **Modern borders** - Prefer 1-2px borders or subtle shadows over thick (4px+) borders
- **Consistent spacing** - Define and use a spacing scale, avoid magic numbers
- **Visual hierarchy** - One focal point per section, not everything competing for attention

### File Organization
- **All generated documentation files must be placed in the `docs/` folder**
- Do not create documentation files in the root directory or other locations
- Generated markdown files, research notes, and documentation should go in `usdx/docs/`
- Keep the repository structure clean and organized

### Code Simplification
- Remove unnecessary abstractions
- Prefer explicit code over clever abstractions
- Keep functions small and focused
- Remove unused exports and imports
- Don't add features "just in case" - only add what's needed

### Git Workflow
- Review all changes before committing
- Ensure commits are focused and meaningful
- Rebase on main/master before creating PRs
- Keep commit messages clear and descriptive

### TypeScript & Build Requirements
- **Always test builds locally** before pushing changes
- Fix all TypeScript type errors - never ignore type errors
- Ensure return types match function signatures
- Use explicit return types when type inference is unclear
- Test `npm run build` or `npm run type-check` before committing

### Design Review Standards
- **When user requests visual changes, clarify the goal first**
- Ask: "Do you want more professional polish or more visual impact?"
- **Don't overcorrect** - Subtle changes are often better than dramatic ones
- **Establish a design system** - Pick 1-2 primary colors and stick to them
- **Review with fresh eyes** - Step back and ask "Would I show this to a client?"
- **Test Tailwind classes** - Verify class names exist before using them
- **Professional borders** - Modern design uses subtle borders (1-2px) or shadows, not thick borders everywhere

### Hardhat3 & Development Tooling
- **Hardhat3 Plugin Loading**: Hardhat3 plugins may not register tasks properly when imported. Use direct API calls or ensure plugins are explicitly imported in scripts.
- **Hardhat Network**: Hardhat3 uses EDR (Ethereum Development Runtime) which is in-process. For scripts using `JsonRpcProvider`, start `hardhat node` separately first.
- **Ignition Modules**: Use pre-calculated role hashes in Ignition modules (ESM context limitations). Example: `MINTER_ROLE = "0x9f2df0fed2c77648de5860a4cc508cd0818c85b8b8a1ab4ceeef8d981c8956a6"`
- **Provider Access**: Hardhat3's `hre.network.provider` may not expose standard ethers provider interface. Use `hre.network.connect()` for network access.
- **Nonce Management**: When deploying multiple contracts sequentially, ensure each deployment completes before starting the next to avoid nonce conflicts.
- **ESM Modules**: Hardhat3 requires ESM (`"type": "module"` in package.json). Use `import` not `require`, and handle async module loading properly.

### Self-Assessment Checklist
Before committing, ask:
1. Is all the code I added actually being used?
2. Can I simplify this further?
3. Am I using Tailwind utilities instead of custom CSS?
4. **Have I verified all Tailwind classes are valid?** (border-3 doesn't exist!)
5. Are there any unused imports or exports?
6. Have I moved all generated docs to the docs folder?
7. Is the code readable and maintainable?
8. **Does `npm run build` pass without errors?**
9. **Are all TypeScript types correct?**
10. **Would a professional designer approve this?**
11. **Is there a consistent color palette (max 2-3 colors)?**
12. **Did I establish clear visual hierarchy?**
13. **For Hardhat3 scripts: Does the script work with `hardhat node` running separately?**
14. **Are Ignition modules using pre-calculated hashes instead of runtime calculations?**
